<!DOCTYPE html>
<html>
<head>
    <title>Move test</title>
    <script type="module">
        const squarWidth = 40;
        const squarHeight = 40;
        const imageURL = "skuggan.svg"
        const imgScale = 4;

        window.startGame = function() {
            const canvas = document.getElementById("canvas");
            const rect = canvas.getBoundingClientRect();
            const context = canvas.getContext("2d");
            context.setTransform(imgScale,0,0,imgScale,0,0);
            context.imageSmoothingEnabled = false;
            context.scale(1/imgScale, 1/imgScale)
            const img = new Image();
            img.onload = function() {
                update(squarWidth/2 , squarHeight/2)
            }
            img.src = imageURL;
            let x
            let y

            const update = function(newX, newY){
                x = newX
                y = newY
                context.clearRect(0, 0, canvas.width, canvas.height);
                context.drawImage(img, newX-squarWidth/2, newY-squarHeight/2,squarWidth, squarHeight);
            }

            canvas.addEventListener('mousedown', function (e) { // 'mouseup'
                update(e.pageX-rect.left, e.pageY-rect.top)
            })
            canvas.addEventListener('touchstart', function (e) { // 'touchend'
                update(e.pageX-rect.left, e.pageY-rect.top)
            })
            window.addEventListener('keyup', (event) => {
                switch (event.key) {
                    case 'ArrowLeft':
                        update(x-5, y)
                        break;
                    case 'ArrowRight':
                        update(x+5, y)
                        break;
                    case 'ArrowUp':
                        update(x, y-5)
                        break;
                    case 'ArrowDown':
                        update(x, y+5)
                        break;
                    default:
                        alert("Only Arrow Keys Are Allowed!");
                }
            });
        }
    </script>
</head>
<body onload="startGame()">
    <canvas id="canvas" style="width:300;height:200;border:4px solid #000000;"></canvas>
    <p>Move Sommarskuggan with your finger, mouse or arrow keys.</p>
</body>
</html>